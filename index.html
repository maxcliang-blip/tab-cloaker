<!DOCTYPE html>
<html>
<head>
    <title>404 Not Found</title>
    <link rel="icon" type="image/png" href="https://ssl.gstatic.com">
    <style>
        body { margin: 0; font-family: sans-serif; background: #fff; height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        #shadow { text-align: center; color: #333; }
        #error404 { font-size: 50px; cursor: default; user-select: none; }
        .trigger { cursor: pointer; color: inherit; }
        
        #mainUI { display: none; background: #111; color: white; min-height: 100vh; width: 100%; flex-direction: column; justify-content: center; align-items: center; }
        .container { background: #222; padding: 30px; border-radius: 10px; text-align: center; border: 1px solid #444; width: 480px; box-shadow: 0 10px 30px rgba(0,0,0,0.8); }
        input { display: block; width: 90%; padding: 12px; margin: 10px auto; border-radius: 5px; border: 1px solid #555; background: #000; color: #0f0; font-family: monospace; }
        button { padding: 10px 20px; cursor: pointer; background: #1a73e8; color: white; border: none; border-radius: 5px; font-weight: bold; width: 100%; margin-top: 10px; }
        .launch-btn { background: #34a853; font-size: 1.1rem; }
        #favList { margin-top: 10px; text-align: left; background: #111; padding: 10px; border: 1px solid #333; max-height: 100px; overflow-y: auto; font-size: 0.8rem; }
    </style>
</head>
<body>

    <div id="shadow">
        <h1 id="error404">Error <span class="trigger" onclick="unlock()">4</span>04</h1>
        <p>The requested URL was not found on this server.</p>
    </div>

    <div id="mainUI">
        <div class="container">
            <h1>Elite Cloaker v29</h1>
            <input type="password" id="pswd" placeholder="Master Key...">
            <div id="controls" style="display:none;">
                <input type="text" id="target" placeholder="https://site-to-hide.com">
                <button onclick="saveLink()">Encrypt & Save Link</button>
                <div id="favList"></div>
                <hr style="border:0; border-top:1px solid #444; margin:15px 0;">
                <input type="text" id="panic" value="https://classroom.google.com" placeholder="Panic URL">
                <button class="launch-btn" onclick="launch()">Launch Encrypted Tab</button>
            </div>
            <button id="unlckBtn" onclick="verify()">Unlock Data</button>
        </div>
    </div>

    <script>
        const PASS = "123"; // Use this as the encryption salt

        function unlock() { document.getElementById('shadow').style.display='none'; document.getElementById('mainUI').style.display='flex'; document.title="Classes"; }
        
        function verify() { 
            if(document.getElementById('pswd').value === PASS) { 
                document.getElementById('controls').style.display='block'; 
                document.getElementById('unlckBtn').style.display='none'; 
                renderFavs();
            } 
        }

        // --- 1. ENCRYPTED SAVED LINKS ---
        // Simple Base64 + XOR with your password to hide links from admins
        function xorEncrypt(str, key) {
            return btoa(str.split('').map((char, i) => String.fromCharCode(char.charCodeAt(0) ^ key.charCodeAt(i % key.length))).join(''));
        }

        function saveLink() {
            const url = document.getElementById('target').value;
            if(!url.startsWith('https://')) return alert("Must use https://");
            let encryptedFavs = JSON.parse(localStorage.getItem('encFavs') || "[]");
            encryptedFavs.push(xorEncrypt(url, PASS));
            localStorage.setItem('encFavs', JSON.stringify(encryptedFavs));
            renderFavs();
        }

        function renderFavs() {
            const list = document.getElementById('favList');
            const encryptedFavs = JSON.parse(localStorage.getItem('encFavs') || "[]");
            list.innerHTML = encryptedFavs.length ? '' : 'No Encrypted Links';
            encryptedFavs.forEach((enc, i) => {
                const decrypted = xorEncrypt(atob(enc), PASS);
                list.innerHTML += `<div style="padding:2px;cursor:pointer;color:#4285F4;" onclick="document.getElementById('target').value='${decrypted}'">${decrypted}</div>`;
            });
        }

        function launch() {
            const url = document.getElementById('target').value;
            const esc = document.getElementById('panic').value;
            
            const pageHTML = `
                <html>
                <head>
                    <title>Classes</title>
                    <link rel="icon" type="image/png" href="https://ssl.gstatic.com">
                    <style>
                        body,html{margin:0;padding:0;height:100%;overflow:hidden;background:#fff;}
                        iframe{width:100%;height:100%;border:none;}
                        #whiteout{display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:#fff; z-index:999; justify-content:center; align-items:center; font-family:sans-serif; color:#666;}
                    </style>
                </head>
                <body>
                    <div id="whiteout"><h1>Connection Timed Out</h1><p>Please refresh the page or check your internet connection.</p></div>
                    <iframe src="${url}"></iframe>
                    <script>
                        // --- 2. CLEAN URL MASKING ---
                        setInterval(() => { history.replaceState(null, "Classes", "about:blank"); }, 50);

                        // --- 3. DOUBLE PANIC ---
                        window.onbeforeunload = () => "Safety";
                        window.addEventListener('keydown', (e) => {
                            // Panic 1: Backslash (\) -> Redirect
                            if (e.code === 'Backslash') { 
                                window.onbeforeunload = null; 
                                window.location.replace("${esc}"); 
                            }
                            // Panic 2: Shift + Escape -> Whiteout Error Screen
                            if (e.shiftKey && e.code === 'Escape') {
                                document.getElementById('whiteout').style.display = 'flex';
                            }
                        });
                        setInterval(() => { window.focus(); }, 500);
                    <\/script>
                </body>
                </html>
            `;
            const blob = new Blob([pageHTML], { type: 'text/html' });
            const win = window.open('about:blank', '_blank');
            if (win) win.location.href = URL.createObjectURL(blob);
        }
    </script>
</body>
</html>
